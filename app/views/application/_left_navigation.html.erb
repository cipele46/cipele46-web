<script type="text/javascript">
  $(function() {
    $("aside a").click(function(e) {
      e.preventDefault();
      var query = $.deserialize(URI($(this).attr("href")).query());
      for(var key in query) {
        $("form#filter_form").find("[name=" + key + "]").val(query[key]);
      }
      $("form#filter_form").submit();
    });
  });
</script>
<aside class="page-sidebar">
  <nav class="cards-board-filter">
    <ul id="cards-board-filter-nav">
        <% if current_user %>
        <li class="expanded">
          <a href="#">Moj kutak</a>
          <ul>
            <li><a href="#">Moji oglasi (<%= current_user.ads.count %>)</a></li>
            <li><a href="#">Moji favoriti (123)</a></li>
          </ul>
        </li>
        <% end -%>
        <li class="expanded">
            <a href="#">Vrsta oglasa</a>
            <ul>
                <li class="<%=[Ad::TYPES[:supply], Ad::TYPES[:demand]].include?(selected_ad_type) ? 
                  '' : 'current'%>">
                  <%= link_to "Svi oglasi (#{number_of_ads_in(:ad_type)})", ads_path(:ad_type => 0) %>          
                </li>

                <li class="giving <%= selected_ad_type == Ad::TYPES[:supply] ? 'current': ''%>">
                  <%= link_to "Ponuda (#{number_of_ads_in(:ad_type, Ad::TYPES[:supply])})", ads_path(:ad_type => Ad::TYPES[:supply]) %>
                </li>

                <li class="receiving <%= selected_ad_type == Ad::TYPES[:demand] ? 'current': ''%>">
                  <%= link_to "Potražnja (#{number_of_ads_in(:ad_type, Ad::TYPES[:demand])})", ads_path(:ad_type => Ad::TYPES[:demand])%>
                </li>
            </ul>
        </li>
        <li class="expanded">
            <a href="#">Kategorije</a>
            <ul>
                <li class="<%= selected_category_id == 0 ? 'current' : ''%>">
                  <%= link_to "Sve kategorije (#{number_of_ads_in(:category_id)})", ads_path(category_id: 0) %>
                </li>
                <% Category.scoped.each do |category| %>
                  <li class="<%= selected_category_id == category.id ? 'current' : ''%>">
                    <%= link_to "#{category.name} (#{number_of_ads_in(:category_id, category.id)})", 
                      ads_path(category_id: category.id) %>
                  </li>
                <% end -%>
            </ul>
        </li>
        <li class="expanded">
            <a href="#">Županije</a>
            <ul>
                <li class="<%= selected_region_id == 0 ? 'current' : ''%>">
                  <%= link_to "Sve županije (#{number_of_ads_in(:region_id)})", ads_path(region_id: 0) %>
                </li>
                <% Region.scoped.each do |region| %>
                  <li class="<%= selected_region_id == region.id ? 'current' : '' %>">
                    <%= link_to "#{region.name} (#{number_of_ads_in(:region_id, region.id)})", 
                      ads_path(region_id: region.id) %>
                  </li>
                <% end -%>
            </ul>
        </li>
    </ul>
  </nav>
</aside>
